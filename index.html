<!-- START: JavaScript to hide the loader when Flutter is ready (ROBUST VERSION 2.0) -->
<script>
    window.addEventListener('load', function(ev) {
      // Get a reference to the loader element.
      var loadingIndicator = document.getElementById("loading-indicator");

      _flutter.loader.loadEntrypoint({
        onEntrypointLoaded: function(engineInitializer) {
          engineInitializer.initializeEngine().then(function(appRunner) {
            // The try/finally block is still good practice.
            try {
              return appRunner.runApp();
            } finally {
              // This is the guaranteed execution block.
              if (loadingIndicator) {
                console.log("Flutter is ready, hiding loading indicator...");

                // 1. Start the fade-out animation for a smooth visual transition.
                loadingIndicator.classList.add('fade-out');
                
                // 2. Immediately prevent it from capturing clicks or interfering.
                loadingIndicator.style.pointerEvents = 'none';

                // 3. After the animation, forcefully hide it and then remove it.
                // This is the key change. We use display: 'none' as a final hammer.
                setTimeout(function() {
                  loadingIndicator.style.display = 'none'; // Force hide
                  loadingIndicator.remove(); // Then clean up the DOM
                }, 500); // This must match your CSS animation duration.
              }
            }
          });
        }
      });
    });
</script>
<!-- END: JavaScript to hide the loader -->```

### Why This Works

1.  **Guaranteed Execution:** The `finally` block ensures this code runs no matter what.
2.  **Immediate UI Unblocking:** `pointerEvents = 'none'` instantly stops the loader from interfering with your Flutter UI, even while it's still visible and fading out.
3.  **The "Hammer": `display = 'none'`**: This is the most important change. After 500 milliseconds (the duration of your fade animation), this command tells the browser to completely stop rendering the element. It's a much more powerful and immediate instruction than just relying on the animation to finish. Even if the animation stutters, this will hide the element.
4.  **`remove()`:** Finally, we clean up the DOM by removing the element entirely.

---

### Complete `web/index.html` with the Final Fix

Here is the full, corrected file for you to copy and paste.

```html
<!DOCTYPE html>
<html>
<head>
    <base href="./">

    <meta charset="UTF-8">
    <meta content="IE-Edge" http-equiv="X-UA-Compatible">
    <meta name="description" content="Official IGM for MMG SHIPPING LINES LTD.">

    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="igm">
    <link rel="apple-touch-icon" href="./icons/Icon-192.png">

    <link rel="icon" type="image/png" href="./favicon.png"/>

    <title>igm</title>
    <link rel="manifest" href="./manifest.json">

    <script src="./js/camera_logic.js" defer></script>
    <script src="./js/face-api.js" defer></script>
    <script src="./js/face-api-helper.js" defer></script>
    <script src="./js/face_worker.js" defer></script>

    <style>
        body {
          background-color: #000000;
          margin: 0;
        }

        #loading-indicator {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: center;
          color: #FFFFFF;
          font-family: Arial, sans-serif;
          z-index: 9999;
        }

        #loading-indicator img {
          width: 30vmin;
          height: 30vmin;
          object-fit: contain;
          margin-bottom: 25px;
        }

        .spinner {
          border: 8px solid #ffffff;
          border-top: 8px solid #014939;
          border-radius: 50%;
          width: 60px;
          height: 60px;
          animation: spin 1.5s linear infinite;
          -webkit-animation: spin 1.5s linear infinite;
        }

        #loading-indicator p {
          margin-top: 20px;
          font-size: 16px;
          letter-spacing: 1px;
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
        @-webkit-keyframes spin {
          0% { -webkit-transform: rotate(0deg); }
          100% { -webkit-transform: rotate(360deg); }
        }

        .fade-out {
          animation: fadeOut 0.5s forwards;
        }

        @keyframes fadeOut {
          from { opacity: 1; }
          to { opacity: 0; }
        }
    </style>
</head>
<body>
<div id="loading-indicator">
    <img src="./moth.jpeg" alt="Loading Moth">
    <!-- You had these commented out, which is fine -->
    <!-- <div class="spinner"></div> -->
    <!-- <p>Initializing Moth Engine...</p> -->
</div>

<script src="./flutter_bootstrap.js" async></script>

<!-- START: JavaScript to hide the loader when Flutter is ready (ROBUST VERSION 2.0) -->
<script>
    window.addEventListener('load', function(ev) {
      // Get a reference to the loader element.
      var loadingIndicator = document.getElementById("loading-indicator");

      _flutter.loader.loadEntrypoint({
        onEntrypointLoaded: function(engineInitializer) {
          engineInitializer.initializeEngine().then(function(appRunner) {
            // Use a try/finally block for guaranteed execution.
            try {
              return appRunner.runApp();
            } finally {
              // This block will run ALWAYS after runApp() is called.
              if (loadingIndicator) {
                console.log("Flutter is ready, hiding loading indicator...");

                // 1. Start the fade-out animation.
                loadingIndicator.classList.add('fade-out');
                
                // 2. Immediately prevent it from capturing clicks.
                loadingIndicator.style.pointerEvents = 'none';

                // 3. After the animation, forcefully hide it and then remove it.
                setTimeout(function() {
                  loadingIndicator.style.display = 'none'; // Force hide
                  loadingIndicator.remove(); // Clean up the DOM
                }, 500); // This must match your CSS animation duration.
              }
            }
          });
        }
      });
    });
</script>
<!-- END: JavaScript to hide the loader -->
</body>
</html>
